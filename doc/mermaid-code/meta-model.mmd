---
config:
  theme: redux
  layout: elk
  look: neo
---
classDiagram
direction TB
    class IoTSystem {
	    name: String
	    brokerHost: String
	    brokerPort: Integer
    }

    class Node {
	    name: String
	    ipAddress: String
    }

    class Topic {
	    name: String
	    qos: QoS
    }

    class Sensor {
	    name: String
	    type: SensorType
	    gpioPin: Integer
	    sampleRate: Duration
    }

    class Actuator {
	    name: String
	    type: ActuatorType
	    gpioPin: Integer
    }

    class ActuatorAction {
	    state: State
	    duration: Duration
    }

    class Coordinator {
	    name: String
    }

    class Rule {
	    name: String
    }

    class Trigger {
	    name: String
    }

    class Condition {
    }

    class Action {
    }

    class SimpleCondition {
	    operator: Operator
    }

    class TemporalCondition {
	    duration: Duration
    }

    class CompoundCondition {
	    logicalOperator: LogicalOperator
    }

    class PublishAction {
	    message: String
    }

    class ActivateAction {
	    duration: Duration
    }

    class Expression {
    }

    class Literal {
	    value: Object
    }

    class SensorValue {
	    field: String
    }

    class SensorType {
	    TEMPERATURE
	    HUMIDITY
	    MOTION
	    LIGHT
	    DISTANCE
    }

    class ActuatorType {
	    RELAY
	    LED
	    BUZZER
	    SERVO
    }

    class Operator {
	    GREATER_THAN
	    LESS_THAN
	    EQUALS
    }

    class LogicalOperator {
	    AND
	    OR
    }

    class QoS {
	    AT_MOST_ONCE
	    AT_LEAST_ONCE
	    EXACTLY_ONCE
    }

    class State {
	    ON
	    OFF
    }

	<<abstract>> Condition
	<<abstract>> Action
	<<abstract>> Expression
	<<enumeration>> SensorType
	<<enumeration>> ActuatorType
	<<enumeration>> Operator
	<<enumeration>> LogicalOperator
	<<enumeration>> QoS
	<<enumeration>> State

    IoTSystem "1" *-- "1..*" Node
    IoTSystem "1" *-- "0..*" Topic
    IoTSystem "1" *-- "0..*" Sensor
    IoTSystem "1" *-- "0..*" Actuator
    IoTSystem "1" *-- "0..*" Coordinator
    Sensor --> Node : deployed on
    Actuator --> Node : deployed on
    Coordinator --> Node : deployed on
    Sensor --> "0..*" Topic : publishes to
    Actuator --> "1..*" Topic : subscribes to
    Coordinator --> "1..*" Topic : subscribes to
    Coordinator --> "0..*" Topic : publishes to
    Actuator *-- "1..*" ActuatorAction
    ActuatorAction --> "1" Topic : from
    Sensor *-- "0..*" Trigger
    Coordinator *-- "0..*" Rule
    Trigger *-- "1" Condition
    Trigger *-- "1..*" Action
    Rule *-- "1" Condition
    Rule *-- "1..*" Action
    Condition <|-- SimpleCondition
    Condition <|-- TemporalCondition
    Condition <|-- CompoundCondition
    CompoundCondition --> "2..*" Condition : combines
    Action <|-- PublishAction
    Action <|-- ActivateAction
    Expression <|-- Literal
    Expression <|-- SensorValue
    SimpleCondition --> "2" Expression
    TemporalCondition --> "1" Condition
    PublishAction --> Topic
    ActivateAction --> Actuator
    Sensor ..> SensorType
    Actuator ..> ActuatorType
    SimpleCondition ..> Operator
    CompoundCondition ..> LogicalOperator
    Topic ..> QoS
    ActuatorAction ..> State